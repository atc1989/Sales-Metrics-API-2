<section id="supabase-sales-upload-section" class="page">
  <header class="page-header">
    <h1 class="page-title">Sales Upload (Supabase)</h1>
    <p class="page-subtitle">Upload Excel sales files, preview items, and import into Supabase.</p>
  </header>

  <form id="sales-upload-form" class="toolbar">
    <label>
      Excel file
      <input type="file" id="excelFile" accept=".xlsx,.xls" />
    </label>
    <label>
      Sheet
      <select id="sheetSelect">
        <option value="__ALL__">All Sheets (Recommended)</option>
      </select>
    </label>
    <button type="button" id="parsePreviewBtn">Parse & Preview</button>
    <button type="button" id="importBtn" disabled>Import to Supabase</button>
  </form>

  <div id="statusArea" class="empty-state" style="display:none;"></div>

  <form id="sales-upload-filter-form" class="toolbar">
    <label>
      From
      <input id="startDate" type="date" aria-label="Start date" required />
    </label>
    <label>
      To
      <input id="endDate" type="date" aria-label="End date" required />
    </label>
    <button type="submit">Apply Filter</button>
  </form>

  <div id="summaryCards" class="card-grid"></div>

  <div class="table-toolbar">
    <div class="table-toolbar-left">
      <label class="table-search-label">
        Table search
        <div class="table-search-row">
          <input
            type="text"
            id="tableSearch"
            class="table-search-input"
            placeholder="Search in current results..."
            aria-label="Search in table"
          />
          <button type="button" id="clearSearch" class="table-search-clear-btn" disabled>
            Clear
          </button>
        </div>
      </label>
    </div>
    <div class="table-toolbar-right">
      <button type="button" id="exportCsv" class="export-btn">CSV</button>
      <button type="button" id="exportXlsx" class="export-btn">Excel</button>
      <button type="button" id="exportPdf" class="export-btn">PDF</button>
    </div>
  </div>

  <div class="table-wrapper">
    <div id="tableContainer" class="table-container"></div>
  </div>
</section>

<div id="itemsModal" class="modal hidden" aria-hidden="true">
  <div class="modal__backdrop" data-close="1"></div>
  <div class="modal__dialog" role="dialog" aria-modal="true" aria-labelledby="itemsModalTitle">
    <div class="modal__header">
      <h3 id="itemsModalTitle">Items Preview</h3>
      <button id="itemsModalClose" type="button" aria-label="Close">x</button>
    </div>
    <div class="modal__body">
      <div id="itemsModalMeta"></div>
      <div id="itemsModalWarnings" class="warn hidden"></div>
      <div id="itemsModalList"></div>
    </div>
    <div class="modal__footer">
      <button id="itemsModalOk" type="button">OK</button>
    </div>
  </div>
</div>
